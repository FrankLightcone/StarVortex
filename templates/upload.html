<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>作业提交系统</title>
    
    <!-- Tailwind -->
    <link href="https://cdn.bootcdn.net/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdn.bootcdn.net/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">

    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    <link href="/static/css/upload.css" rel="stylesheet">
    <link href="/static/css/feedback.css" rel="stylesheet">
    <link href="/static/css/course_materials.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/flowbite@3.1.2/dist/flowbite.min.css" rel="stylesheet" />

    
    {% if current_user.is_authenticated %}
    <script src="{{ url_for('static', filename='js/marked.min.js') }}"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/notification.css') }}">
    <script src="{{ url_for('static', filename='js/notification.js') }}"></script>
    {% endif %}
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body class="bg-gray-50 min-h-screen font-sans">
    <!-- Toast Notification -->
    <div 
        id="toast" 
        class="fixed top-4 left-1/2 z-50 px-4 py-3 bg-red-500 text-white rounded-lg shadow-lg text-center flex items-center"
    >
        <i class="fas fa-exclamation-circle mr-2"></i>
        <span>提示信息</span>
    </div>

    <!-- 顶部导航栏 -->
    <nav class="bg-white shadow-sm sticky top-0 z-10">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex">
                    <div class="flex-shrink-0 flex items-center">
                        <img src="/static/img/logo.png" alt="Logo" class="h-10 w-auto">
                        <span class="ml-2 text-xl font-bold text-gray-800">作业传输系统</span>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="relative">
                        <div class="flex items-center cursor-pointer user-profile-menu">
                            <span class="bg-blue-100 p-2 rounded-full text-blue-600">
                                <i class="fas fa-user"></i>
                            </span>
                            <span class="ml-2 text-gray-700 hidden sm:inline-block">欢迎, <span id="userName">{{ user_name }}</span></span>
                            <i class="fas fa-chevron-down ml-2 text-gray-500 text-xs"></i>
                        </div>
                        <div class="user-dropdown absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 hidden">
                            <a href="#" id="viewProfileBtn" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                                <i class="fas fa-user-circle mr-2"></i> 个人资料
                            </a>
                            <a href="/logout" class="block px-4 py-2 text-sm text-red-600 hover:bg-gray-100">
                                <i class="fas fa-sign-out-alt mr-2"></i> 退出登录
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- 主内容区 -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
        <!-- 标签页头部 -->
        <div class="tabs-container mb-6">
            <nav class="tab-nav">
                <button id="tabUpload" class="tab-button active">
                    <i class="fas fa-upload mr-2"></i>提交作业
                </button>
                <button id="tabAssignmentsList" class="tab-button">
                    <i class="fas fa-list-alt mr-2"></i>作业列表
                </button>
                <button id="tabSubmissions" class="tab-button">
                    <i class="fas fa-history mr-2"></i>我的提交
                </button>
                <button id="tabMaterials" class="tab-button">
                    <i class="fas fa-book mr-2"></i>课程资料
                </button>
                <button id="tabProfile" class="tab-button">
                    <i class="fas fa-user-cog mr-2"></i>个人设置
                </button>
                
            </nav>
        </div>

        <!-- 提交作业标签页 -->
        <div id="uploadTab" class="tab-content active">
            <div class="bg-white rounded-xl shadow-sm overflow-hidden">
                <div class="px-6 py-5 border-b border-gray-100 flex justify-between items-center">
                    <h3 class="text-lg leading-6 font-semibold text-gray-900 flex items-center">
                        <i class="fas fa-file-upload mr-2 text-blue-500"></i>作业提交
                    </h3>
                </div>
                <div class="px-6 py-5">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                        <div>
                            <label for="course" class="block text-sm font-medium text-gray-700 mb-1">
                                选择课程
                            </label>
                            <div class="relative">
                                <select 
                                    id="course" 
                                    name="course" 
                                    required 
                                    class="form-select block w-full focus:ring-blue-500 focus:border-blue-500 rounded-lg shadow-sm"
                                >
                                    <option value="">请选择课程</option>
                                    {% for course in courses %}
                                    <option value="{{ course }}">{{ course }}</option>
                                    {% endfor %}
                                </select>
                                <div class="absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none">
                                    <i class="fas fa-chevron-down text-gray-400"></i>
                                </div>
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">
                                班级
                            </label>
                            <div class="relative">
                                <div class="form-input block w-full px-3 py-2 bg-gray-100 border border-gray-300 rounded-lg shadow-sm text-gray-500">
                                    {{ user_class_name }}
                                    <input type="hidden" id="class_name" name="class_name" value="{{ user_class_name }}">
                                </div>
                                <div class="absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none">
                                    <i class="fas fa-users text-gray-400"></i>
                                </div>
                            </div>
                        </div>
                        
                        <div>
                            <label for="assignment_name" class="block text-sm font-medium text-gray-700 mb-1">
                                作业名称
                            </label>
                            <div class="relative">
                                <select 
                                    id="assignment_name" 
                                    name="assignment_name" 
                                    required 
                                    class="form-select block w-full focus:ring-blue-500 focus:border-blue-500 rounded-lg shadow-sm"
                                    disabled
                                >
                                    <option value="">请先选择课程</option>
                                </select>
                                <div class="absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none">
                                    <i class="fas fa-chevron-down text-gray-400"></i>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 作业状态信息 -->
                    <div id="assignmentInfo" class="assignment-info-card mb-6 hidden">
                        <div class="grid grid-cols-2 sm:grid-cols-4 gap-4">
                            <div class="stat-item">
                                <div class="text-sm font-medium text-gray-500">截止日期</div>
                                <div id="assignmentDueDate" class="stat-value">-</div>
                            </div>
                            <div class="stat-item">
                                <div class="text-sm font-medium text-gray-500">已提交人数</div>
                                <div id="assignmentSubmissionCount" class="stat-value">-</div>
                            </div>
                            <div class="stat-item">
                                <div class="text-sm font-medium text-gray-500">提交状态</div>
                                <div id="assignmentStatus" class="stat-value">-</div>
                            </div>
                            <div class="stat-item">
                                <div class="text-sm font-medium text-gray-500">我的提交</div>
                                <div id="mySubmissionStatus" class="stat-value">-</div>
                            </div>
                        </div>
                        <div id="assignmentLimits" class="mt-4 pt-4 border-t border-gray-200">
                            <h4 class="text-sm font-medium text-gray-700 mb-2 flex items-center">
                                <svg class="w-4 h-4 mr-1 text-blue-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                </svg>
                                提交限制
                            </h4>
                            <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                                <div class="flex items-center text-sm text-gray-600">
                                    <svg class="w-4 h-4 mr-1 text-gray-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
                                    </svg>
                                    <span id="maxFileSize">文件大小: 最大 256 MB</span>
                                </div>
                                <div class="flex items-center text-sm text-gray-600">
                                    <svg class="w-4 h-4 mr-1 text-gray-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                    </svg>
                                    <span id="maxFileCount">文件数量: 最多 10 个</span>
                                </div>
                                <div class="flex items-center text-sm text-gray-600">
                                    <svg class="w-4 h-4 mr-1 text-gray-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                    </svg>
                                    <span id="dailyQuota">每日限额: 1 GB</span>
                                </div>
                                <div class="flex items-center text-sm text-gray-600">
                                    <svg class="w-4 h-4 mr-1 text-gray-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                    </svg>
                                    <span id="allowedTypes">允许的文件类型</span>
                                </div>
                            </div>
                            <div class="mt-2">
                                <div id="fileTypesTags" class="flex flex-wrap gap-1.5">
                                    <!-- 这里将动态添加文件类型标签 -->
                                </div>
                            </div>
                            <div class="mt-3 text-xs text-gray-500 bg-blue-50 p-2 rounded">
                                <p id="assignmentDescription" class="italic">暂无作业描述...</p>
                            </div>
                        </div>
                    </div>

                    <div 
                        id="dropZone" 
                        class="drop-zone"
                    >
                        <input 
                            type="file" 
                            id="fileInput" 
                            class="hidden" 
                            multiple
                        >
                        <div id="dropText" class="flex flex-col items-center justify-center">
                            <div class="file-icon">
                                <i class="fas fa-cloud-upload-alt"></i>
                            </div>
                            <p class="text-gray-500 mt-2">点击或拖拽文件到此处选择上传文件</p>
                            <p class="text-gray-400 text-xs mt-1">支持PDF、Word、Excel、图片等格式</p>
                        </div>
                    </div>

                    <!-- 待上传文件列表 -->
                    <div id="fileList" class="file-list hidden">
                        <!-- 文件列表将通过 JavaScript 添加 -->
                    </div>

                    <div id="progressContainer" class="progress-container">
                        <div class="flex justify-between text-sm text-gray-600 mb-1">
                            <span id="fileName" class="text-ellipsis overflow-hidden">filename.txt</span>
                            <span id="uploadSpeed">0 KB/s</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2.5">
                            <div 
                                id="progressBar" 
                                class="bg-blue-600 h-2.5 rounded-full" 
                                style="width: 0%"
                            ></div>
                        </div>
                        <div class="text-center mt-2 text-sm text-gray-600">
                            <span id="progressText">上传中: 0%</span>
                        </div>
                    </div>

                    <div class="mt-6">
                        <button 
                            id="uploadBtn" 
                            class="upload-button"
                            disabled
                        >
                            <i class="fas fa-upload mr-2"></i>开始上传
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 作业列表标签页 -->
        <div id="assignmentsListTab" class="tab-content">
            <div class="bg-white rounded-xl shadow-sm overflow-hidden">
                <div class="px-6 py-5 border-b border-gray-100 flex justify-between items-center">
                    <h3 class="text-lg leading-6 font-semibold text-gray-900 flex items-center">
                        <i class="fas fa-list-alt mr-2 text-blue-500"></i>作业发布列表
                    </h3>
                    <div class="flex items-center space-x-3">
                        <button id="refreshAssignmentsBtn" class="refresh-button">
                            <i class="fas fa-sync-alt mr-1.5"></i>刷新
                        </button>
                        <div class="relative">
                            <select 
                                id="assignmentStatusFilter" 
                                class="form-select block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md"
                            >
                                <option value="all">所有作业&nbsp;&nbsp;</option>
                                <option value="pending">未截止</option>
                                <option value="unsubmitted">未提交</option>
                                <option value="submitted">已提交</option>
                                <option value="expired">已截止</option>
                            </select>
                            <div class="absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none">
                                <i class="fas fa-chevron-down text-gray-400"></i>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="px-6 py-5">
                    <div class="relative overflow-x-auto shadow-md sm:rounded-lg">
                        <table class="w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400">
                            <thead class="text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400">
                                <tr>
                                    <th scope="col" class="px-6 py-3">
                                        课程
                                    </th>
                                    <th scope="col" class="px-6 py-3">
                                        作业名称
                                    </th>
                                    <th scope="col" class="px-6 py-3">
                                        截止日期
                                    </th>
                                    <th scope="col" class="px-6 py-3">
                                        状态
                                    </th>
                                    <th scope="col" class="px-6 py-3">
                                        提交情况
                                    </th>
                                    <th scope="col" class="px-6 py-3 text-right">
                                        操作
                                    </th>
                                </tr>
                            </thead>
                            <tbody id="assignmentsListBodyWrapper">
                            <tbody id="assignmentsListBody" class="bg-white divide-y divide-gray-200">
                                <tr>
                                    <td colspan="6" class="px-6 py-10 text-center text-sm text-gray-500">
                                        <div class="loading-indicator">
                                            <i class="fas fa-spinner fa-spin text-blue-500 text-xl"></i>
                                            <span class="mt-3 block">加载中...</span>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </tbody>
                        </table>
                        <!-- Pagination can be added here if needed -->
                        <!-- 分页导航 -->
                        <nav id="assignmentPagination" class="flex items-center flex-column flex-wrap md:flex-row justify-between pt-6 hidden" aria-label="Table navigation">
                            <span class="page-info text-sm font-medium text-gray-500 dark:text-gray-400 mb-4 md:mb-0 block w-full md:inline md:w-auto bg-gray-50 dark:bg-gray-800 px-4 py-2 rounded-lg shadow-sm">
                                显示 <span class="font-semibold text-blue-600 dark:text-blue-400">1-10</span> 共 <span class="font-semibold text-blue-600 dark:text-blue-400">20</span> 条记录
                            </span>
                            <ul class="pagination-list inline-flex rounded-md shadow-sm">
                                <!-- 页码将由JavaScript动态添加 -->
                            </ul>
                        </nav>
                    </div>
                </div>
            </div>
        </div>

        <!-- 我的提交标签页 -->
        <div id="submissionsTab" class="tab-content">
            <div class="bg-white rounded-xl shadow-sm overflow-hidden">
                <div class="px-6 py-5 border-b border-gray-100">
                    <h3 class="text-lg leading-6 font-semibold text-gray-900 flex items-center">
                        <i class="fas fa-history mr-2 text-blue-500"></i>我的提交记录
                    </h3>
                </div>
                <div class="px-6 py-5">
                    <div class="mb-6">
                        <label for="mySubmissionCourseFilter" class="block text-sm font-medium text-gray-700 mb-1">
                            课程筛选
                        </label>
                        <div class="relative max-w-xs">
                            <select 
                                id="mySubmissionCourseFilter" 
                                class="form-select block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md"
                            >
                                <option value="">全部课程</option>
                                {% for course in courses %}
                                <option value="{{ course }}">{{ course }}</option>
                                {% endfor %}
                            </select>
                            <div class="absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none">
                                <i class="fas fa-chevron-down text-gray-400"></i>
                            </div>
                        </div>
                    </div>

                    <div class="overflow-hidden rounded-lg border border-gray-200">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        课程
                                    </th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        作业名称
                                    </th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        提交时间
                                    </th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        状态
                                    </th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        文件数量
                                    </th>
                                    <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        操作
                                    </th>
                                </tr>
                            </thead>
                            <tbody id="mySubmissionsList" class="bg-white divide-y divide-gray-200">
                                <!-- 动态加载提交列表 -->
                                <tr>
                                    <td colspan="6" class="px-6 py-10 text-center text-sm text-gray-500">
                                        请选择课程查看提交记录
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Course Materials Tab Content -->
        <div id="materialsTab" class="tab-content">
            <div class="bg-white rounded-xl shadow-sm overflow-hidden">
            <div class="px-6 py-5 border-b border-gray-100 flex justify-between items-center">
                <h3 class="text-lg leading-6 font-semibold text-gray-900 flex items-center">
                <i class="fas fa-book mr-2 text-blue-500"></i>课程资料
                </h3>
                <div class="flex space-x-2">
                <div class="relative">
                    <select 
                    id="materialsCourseFilter" 
                    class="form-select block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md"
                    >
                    <option value="">选择课程</option>
                    <!-- 课程选项将通过JavaScript动态添加 -->
                    </select>
                </div>
                </div>
            </div>
            <div class="px-6 py-5">
                <!-- 加载状态 -->
                <div id="materialsLoading" class="flex flex-col items-center justify-center py-10">
                <svg class="animate-spin h-10 w-10 text-blue-500 mb-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
                <p class="text-gray-500">加载资料中...</p>
                </div>
                
                <!-- 没有资料时显示 -->
                <div id="materialsEmpty" class="hidden flex flex-col items-center justify-center py-10">
                <svg class="w-16 h-16 text-gray-300 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                </svg>
                <p class="text-gray-500 text-lg">暂无课程资料</p>
                <p class="text-gray-400 text-sm mt-1">请选择其他课程或联系教师上传资料</p>
                </div>
                
                <!-- 课程卡片容器 -->
                <div id="courseCardContainer" class="hidden grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- 卡片将通过JavaScript动态添加 -->
                </div>
            </div>
            </div>
        </div>
        
        <!-- 资料查看模态框 -->
        <div id="courseAssetsModal" tabindex="-1" class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full">
            <div class="relative p-4 w-full max-w-6xl max-h-full">
            <!-- 模态框内容 -->
            <div class="relative bg-white rounded-lg shadow dark:bg-gray-700">
                <!-- 模态框头部 -->
                <div class="flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600">
                <h3 id="courseAssetsTitle" class="text-xl font-semibold text-gray-900 dark:text-white">
                    课程资料
                </h3>
                <button type="button" class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white" data-modal-hide="courseAssetsModal">
                    <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
                    </svg>
                    <span class="sr-only">关闭</span>
                </button>
                </div>
                
                <!-- 模态框主体 -->
                <div class="p-4 md:p-5">
                <div id="courseAssetsDescription" class="text-sm text-gray-600 mb-5 bg-gray-50 p-3 rounded-lg">
                    课程描述将显示在这里...
                </div>
                
                <h4 class="text-base font-medium text-gray-900 mb-3 flex items-center">
                    <svg class="w-5 h-5 mr-2 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                    </svg>
                    可用资料
                </h4>
                
                <!-- 资料列表 -->
                <div class="relative overflow-x-auto shadow-md sm:rounded-lg mb-4">
                    <table class="w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400">
                    <thead class="text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400">
                        <tr>
                        <th scope="col" class="px-6 py-3">
                            文件名
                        </th>
                        <th scope="col" class="px-6 py-3">
                            类型
                        </th>
                        <th scope="col" class="px-6 py-3">
                            大小
                        </th>
                        <th scope="col" class="px-6 py-3">
                            上传日期
                        </th>
                        <th scope="col" class="px-12 py-3">
                            操作
                        </th>
                        </tr>
                    </thead>
                    <tbody id="courseAssetsList">
                        <!-- 资料项将通过JavaScript动态添加 -->
                        <tr class="bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600">
                        <td class="px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white">
                            加载中...
                        </td>
                        <td class="px-6 py-4">
                            -
                        </td>
                        <td class="px-6 py-4">
                            -
                        </td>
                        <td class="px-6 py-4">
                            -
                        </td>
                        <td class="px-6 py-4">
                            -
                        </td>
                        </tr>
                    </tbody>
                    </table>
                    
                    <div id="paginationControls" class="flex justify-between items-center px-4 pb-4">
                        <nav class="flex items-center space-x-1">
                        <button id="prevPageBtn" class="px-3 py-1 text-sm text-gray-500 bg-white border border-gray-300 rounded hover:bg-gray-100">上一页</button>
                        <span id="paginationInfo" class="text-sm text-gray-600">第 1 页</span>
                        <button id="nextPageBtn" class="px-3 py-1 text-sm text-gray-500 bg-white border border-gray-300 rounded hover:bg-gray-100">下一页</button>
                        </nav>
                    </div>
                    
                </div>
                </div>
            </div>
            </div>
        </div>

        <!-- 个人设置标签页 -->
        <div id="profileTab" class="tab-content">
            <div class="bg-white rounded-xl shadow-sm overflow-hidden">
                <div class="px-6 py-5 border-b border-gray-100">
                    <h3 class="text-lg leading-6 font-semibold text-gray-900 flex items-center">
                        <i class="fas fa-user-cog mr-2 text-blue-500"></i>个人设置
                    </h3>
                </div>
                <div class="px-6 py-5">
                    <form id="profileForm" class="space-y-6">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="profile_name" class="block text-sm font-medium text-gray-700">
                                    姓名 <span class="text-xs text-red-500">(姓名将用于作业文件夹命名，请使用真实姓名)</span>
                                </label>
                                <div class="mt-1 relative">
                                    <input 
                                        type="text" 
                                        id="profile_name" 
                                        name="profile_name" 
                                        class="form-input block w-full pl-3 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md"
                                        value="{{ user_name }}"
                                    >
                                    <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                                        <i class="fas fa-user text-gray-400"></i>
                                    </div>
                                </div>
                            </div>

                            <div>
                                <label for="profile_email" class="block text-sm font-medium text-gray-700">
                                    邮箱
                                </label>
                                <div class="mt-1 relative">
                                    <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                                        <i class="fas fa-envelope text-gray-400"></i>
                                    </div>
                                    <input 
                                        type="email" 
                                        id="profile_email" 
                                        name="profile_email" 
                                        class="form-input block w-full pl-10 py-2 text-base border-gray-300 bg-gray-100 sm:text-sm rounded-md cursor-not-allowed"
                                        value="{{ user_email }}" 
                                        readonly
                                    >
                                </div>
                            </div>

                            <div>
                                <label for="profile_student_id" class="block text-sm font-medium text-gray-700">
                                    学号
                                </label>
                                <div class="mt-1 relative">
                                    <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                                        <i class="fas fa-id-card text-gray-400"></i>
                                    </div>
                                    <input 
                                        type="text" 
                                        id="profile_student_id" 
                                        name="profile_student_id" 
                                        class="form-input block w-full pl-10 py-2 text-base border-gray-300 bg-gray-100 sm:text-sm rounded-md cursor-not-allowed"
                                        value="{{ user_student_id }}" 
                                        readonly
                                    >
                                </div>
                            </div>

                            <div>
                                <label for="profile_student_class" class="block text-sm font-medium text-gray-700">
                                    班级
                                </label>
                                <div class="mt-1 relative">
                                    <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                                        <i class="fas fa-chalkboard-teacher text-gray-400"></i>
                                    </div>
                                    <input 
                                        type="text" 
                                        id="profile_student_class" 
                                        name="profile_student_class" 
                                        class="form-input block w-full pl-10 py-2 text-base border-gray-300 bg-gray-100 sm:text-sm rounded-md cursor-not-allowed"
                                        value="{{ user_class_name }}" 
                                        readonly
                                    >
                                </div>
                            </div>
                        </div>

                        <div class="mt-8 border-t border-gray-200 pt-6">
                            <h4 class="text-md font-medium text-gray-900 mb-4">更改密码</h4>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                                <div>
                                    <label for="profile_current_password" class="block text-sm font-medium text-gray-700">
                                        当前密码
                                    </label>
                                    <div class="mt-1 relative">
                                        <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                                            <i class="fas fa-lock text-gray-400"></i>
                                        </div>
                                        <input 
                                            type="password" 
                                            id="profile_current_password" 
                                            name="profile_current_password" 
                                            class="form-input block w-full pl-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md"
                                        >
                                    </div>
                                </div>

                                <div>
                                    <label for="profile_new_password" class="block text-sm font-medium text-gray-700">
                                        新密码
                                    </label>
                                    <div class="mt-1 relative">
                                        <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                                            <i class="fas fa-key text-gray-400"></i>
                                        </div>
                                        <input 
                                            type="password" 
                                            id="profile_new_password" 
                                            name="profile_new_password" 
                                            class="form-input block w-full pl-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md"
                                        >
                                    </div>
                                </div>

                                <div>
                                    <label for="profile_confirm_password" class="block text-sm font-medium text-gray-700">
                                        确认新密码
                                    </label>
                                    <div class="mt-1 relative">
                                        <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                                            <i class="fas fa-check-circle text-gray-400"></i>
                                        </div>
                                        <input 
                                            type="password" 
                                            id="profile_confirm_password" 
                                            name="profile_confirm_password" 
                                            class="form-input block w-full pl-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md"
                                        >
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="flex justify-end mt-8">
                            <button 
                                type="submit" 
                                class="profile-save-button"
                            >
                                <i class="fas fa-save mr-2"></i>保存修改
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- 查看提交详情弹窗 -->
    <div id="mySubmissionDetailModal" class="modal-backdrop hidden">
        <div class="modal-container">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="mySubmissionDetailTitle" class="modal-title">
                        <i class="fas fa-file-alt mr-2"></i>提交详情
                    </h3>
                    <button id="closeMySubmissionDetailBtn" class="modal-close-btn">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div id="mySubmissionDetail" class="modal-body">
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4">
                        <div class="detail-item">
                            <div class="detail-label">课程</div>
                            <div id="detailCourse" class="detail-value">-</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">作业名称</div>
                            <div id="detailAssignmentName" class="detail-value">-</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">提交时间</div>
                            <div id="detailSubmissionTime" class="detail-value">-</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">截止日期</div>
                            <div id="detailAssignmentDueDate" class="detail-value">-</div>
                        </div>
                    </div>

                    <h4 class="text-md font-medium text-gray-900 mt-6 mb-3 flex items-center">
                        <i class="fas fa-paperclip mr-2 text-blue-500"></i>已提交文件
                    </h4>
                    <div class="overflow-hidden rounded-lg border border-gray-200">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        文件名
                                    </th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        大小
                                    </th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        提交时间
                                    </th>
                                    <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        操作
                                    </th>
                                </tr>
                            </thead>
                            <tbody id="myFilesList" class="bg-white divide-y divide-gray-200">
                                <!-- 动态加载文件列表 -->
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="modal-footer">
                    <button
                        type="button"
                        id="replaceSubmissionBtn"
                        class="modal-btn-primary"
                    >
                        <i class="fas fa-sync-alt mr-2"></i>更新提交
                    </button>
                    <button
                        type="button"
                        id="downloadSubmissionBtn"
                        class="modal-btn-secondary"
                    >
                        <i class="fas fa-download mr-2"></i>下载所有文件
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/apexcharts@3.46.0/dist/apexcharts.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/3.1.2/flowbite.min.js"></script>
    <script src="/static/js/assignment-chart.js"></script>
    <script src="/static/js/toast.js"></script>
    <script src="/static/js/utils.js"></script>
    <script src="/static/js/upload.js"></script>
    <script src="/static/js/feedback.js"></script>
    <script src="/static/js/course_materials.js"></script>
    <script>
        // 用户下拉菜单交互
        document.addEventListener('DOMContentLoaded', function() {
            // 用户菜单交互
            const userMenu = document.querySelector('.user-profile-menu');
            const userDropdown = document.querySelector('.user-dropdown');
            
            if (userMenu && userDropdown) {
                userMenu.addEventListener('click', function(e) {
                    e.stopPropagation();
                    userDropdown.classList.toggle('hidden');
                });
                
                // 点击其他地方关闭下拉菜单
                document.addEventListener('click', function() {
                    userDropdown.classList.add('hidden');
                });
                
                // 点击个人资料按钮切换到个人设置标签
                document.getElementById('viewProfileBtn').addEventListener('click', function(e) {
                    e.preventDefault();
                    document.getElementById('tabProfile').click();
                });
            }
        });
    </script>
</body>
</html>